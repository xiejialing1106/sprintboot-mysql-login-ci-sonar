# 測試專用 Dockerfile
FROM maven:3.8.4-openjdk-17

# 設定工作目錄
WORKDIR /app

# 複製 pom.xml 並下載依賴
COPY pom.xml .
RUN mvn dependency:go-offline -B

# 複製源代碼
COPY src ./src

# 建立測試結果目錄
RUN mkdir -p /app/test-results

# 設定 Maven 測試配置
ENV MAVEN_OPTS="-Xmx1024m -XX:MaxPermSize=256m"

# 預設命令：執行測試
CMD ["mvn", "clean", "test"]
